spring:
  threads:
    virtual:
      enabled: true
  main:
    web-application-type: none
    banner-mode: off
  application:
    name: maven-tools-mcp
  ai:
    mcp:
      server:
        name: maven-tools-mcp
        version: 2.0.0
        type: SYNC
        instructions: "Universal JVM dependency intelligence server for any build tool using Maven Central Repository. Provides comprehensive dependency analysis, latest version lookup, stability filtering, bulk operations, and upgrade recommendations with intelligent caching support. Works with Maven, Gradle, SBT, Mill, and any JVM build tool."
      client:
        enabled: true                     # Enable MCP client with SSE transport (Docker default)
        type: ASYNC
        request-timeout: 15s
        toolcallback:
          enabled: true                   # Enable exposing Context7 tools as raw MCP tools
        streamable-http:
          connections:
            context7:
              url: https://mcp.context7.com/
  cache:
    type: caffeine

# Logging configuration - let logback-spring.xml handle the appenders
logging:
  level:
    # Your app logs at INFO level (goes to STDERR via logback config)
    "[com.arvindand.mcp.maven]": INFO
    # Framework logs at ERROR level to minimize noise
    "[org.springframework.ai.mcp]": ERROR
    "[org.springframework.boot]": ERROR
    "[org.springframework]": ERROR
    "[org.apache.http]": ERROR
    "[ch.qos.logback]": ERROR
    root: ERROR
  # Keep your logback configuration
  config: "classpath:logback-spring.xml"

# Maven Central Repository configuration
maven:
  central:
    repository-base-url: https://repo1.maven.org/maven2
    timeout: 8s
    max-results: 100
    connection-pool-size: 50

# Resilience4j configuration for Maven Central and OSV API resilience
resilience4j:
  circuitbreaker:
    instances:
      maven-central:
        failure-rate-threshold: 50
        slow-call-rate-threshold: 50
        slow-call-duration-threshold: 5s
        wait-duration-in-open-state: 30s
        permitted-number-of-calls-in-half-open-state: 5
        sliding-window-size: 10
        sliding-window-type: COUNT_BASED
      osv:
        register-health-indicator: true
        failure-rate-threshold: 50
        slow-call-rate-threshold: 50
        slow-call-duration-threshold: 10s
        wait-duration-in-open-state: 60s
        permitted-number-of-calls-in-half-open-state: 3
        sliding-window-size: 10
        sliding-window-type: COUNT_BASED

  retry:
    instances:
      maven-central:
        max-attempts: 3
        wait-duration: 1s
        exponential-backoff-multiplier: 2
        retry-exceptions:
          - java.net.ConnectException
          - java.net.SocketTimeoutException

  ratelimiter:
    instances:
      maven-central:
        limit-for-period: 10
        limit-refresh-period: 1s
        timeout-duration: 0s
      osv:
        limit-for-period: 5
        limit-refresh-period: 1s
        timeout-duration: 10s

# Context7 guidance hints - lightweight suggestions in response models to help LLMs
# effectively use Context7 tools for migration guidance and upgrade strategies.
# No external calls are made - only response enrichment with search hints.
context7:
  enabled: true                       # Set to false to disable Context7 guidance hints in responses
